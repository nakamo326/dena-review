{"version":3,"sources":["components/title.tsx","components/stone.tsx","components/indicator.tsx","components/utils.ts","components/volume.tsx","components/board.tsx","index.tsx","components/remotePlay.ts"],"names":["Title","React","memo","className","Stone","props","color","value","onClick","Indicator","status","left","right","winner","xIsNext","isDraw","isPlaceable","squares","col","row","index","calculateWinner","Math","trunc","dirList","i","line","isOverRun","Set","map","val","size","dir","array","length","element","audioPlay","path","volume","audio","Audio","play","then","console","log","catch","error","warn","Volume","newVolume","classAttribute","setVolume","BoardRow","Board","id","Game","useState","Array","fill","history","setHistory","stepNumber","setStepNumber","setXIsNext","isEnter","setIsEnter","setIsDraw","socket","setSocket","isMyTurn","setIsMyTurn","userId","setUserId","roomId","setRoomId","setStatus","handleMessage","useCallback","newHistory","slice","place","winnerStreak","match","includes","newIsDraw","concat","useEffect","on","msg","json","JSON","parse","isYourTurn","opponentPlayer","connectSocket","io","transports","emit","stringify","e","enterRoom","current","winner_streak","step","type","name","placeholder","disabled","newStatus","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.02dd1aa2.chunk.js","sourcesContent":["import React from 'react';\n\nconst Title = React.memo(function showTitle() {\n  return (\n    <div className=\"game-title\">\n      <span className=\"neon flash\">\n        電<span>電</span>\n      </span>\n      <span className=\"neon flash\">\n        脳<span>脳</span>\n      </span>\n      <span className=\"neon flash\">\n        盤<span>盤</span>\n      </span>\n      <span className=\"neon flash\">\n        上<span>上</span>\n      </span>\n      <span className=\"neon flash\">\n        娯<span>娯</span>\n      </span>\n      <span className=\"neon flash\">\n        楽<span>楽</span>\n      </span>\n      <span className=\"neon flash\">\n        &nbsp;<span>&nbsp;</span>\n      </span>\n      <span className=\"neon flash\">\n        四<span>四</span>\n      </span>\n      <span className=\"neon flash\">\n        子<span>子</span>\n      </span>\n      <span className=\"neon flash\">\n        棋<span>棋</span>\n      </span>\n    </div>\n  );\n});\n\nexport default Title;\n","import React from 'react';\n\ntype DataProps = {\n  value: string | null;\n  onClick: () => void;\n};\n\nconst Stone = (props: DataProps): JSX.Element => {\n  let color;\n  if (props.value === null) color = '';\n  else color = props.value === 'X' ? 'stone-color1' : 'stone-color2';\n  return <button className={'stone ' + color} onClick={props.onClick} />;\n};\n\nexport default Stone;\n","import React from 'react';\nimport Stone from './stone';\n\ntype DataProps = {\n  xIsNext: boolean;\n  isDraw: boolean;\n  winner: string | null;\n};\n\nconst Indicator = (props: DataProps): JSX.Element => {\n  let status;\n  let left: string | null = null;\n  let right: string | null = null;\n  if (props.winner) {\n    status = props.winner;\n  } else {\n    status = props.xIsNext ? 'X' : 'O';\n  }\n  if (!props.isDraw) {\n    if (status === 'X') {\n      left = status;\n    } else {\n      right = status;\n    }\n  }\n  return (\n    <div className=\"indicator\">\n      <Stone\n        value={left}\n        onClick={() => {\n          return;\n        }}></Stone>\n      <Stone\n        value={right}\n        onClick={() => {\n          return;\n        }}></Stone>\n    </div>\n  );\n};\n\nexport default Indicator;\n","//  return placeable index number, or return null if stone is full on col\nexport function isPlaceable(squares: Array<string>, col: number): number | null {\n  for (let row = 5; row >= 0; row--) {\n    const index = row * 7 + col;\n    if (squares[index] === null) {\n      return index;\n    }\n  }\n  return null;\n}\n\nexport function calculateWinner(squares: Array<string>, index: number): Array<number> | null {\n  const row = Math.trunc(index / 7);\n  const col = index % 7;\n  const dirList = [\n    [0, 1],\n    [-1, 1],\n    [-1, 0],\n    [-1, -1],\n    [0, -1],\n    [1, -1],\n    [1, 0],\n    [1, 1],\n  ];\n\n  if (index === 42) return null;\n  if (squares[index] !== null) {\n    for (let i = 0; i < 8; i++) {\n      const line = [\n        (row + dirList[i][0] * 0) * 7 + (col + dirList[i][1] * 0),\n        (row + dirList[i][0] * 1) * 7 + (col + dirList[i][1] * 1),\n        (row + dirList[i][0] * 2) * 7 + (col + dirList[i][1] * 2),\n        (row + dirList[i][0] * 3) * 7 + (col + dirList[i][1] * 3),\n      ];\n      if (!isOverRun(i, line)) continue;\n      const set = new Set(\n        line.map((val) => {\n          return squares[val];\n        }),\n      );\n      if (set.size === 1) {\n        return line;\n      }\n    }\n  }\n  return calculateWinner(squares, index + 1);\n}\n\nfunction isOverRun(dir: number, array: Array<number>) {\n  for (let i = 0; i < array.length; i++) {\n    const element = array[i];\n    const row = Math.trunc(element / 7);\n    const col = element % 7;\n\n    if (\n      (col === 0 && dir >= 3 && dir <= 5) ||\n      (row === 0 && dir >= 1 && dir <= 3) ||\n      (col === 6 && (dir <= 1 || dir === 7)) ||\n      (row === 5 && dir >= 6 && dir <= 8)\n    )\n      return false;\n  }\n  return true;\n}\n\nexport function audioPlay(path: string, volume: number): void {\n  const audio = new Audio(path);\n  audio.volume = volume;\n  audio\n    .play()\n    .then(() => {\n      console.log('Audio started!');\n    })\n    .catch((error) => console.warn(error));\n}\n","import React from 'react';\nimport '../index.css';\nimport { audioPlay } from './utils';\n\ntype VolumeProps = {\n  volume: number;\n  setVolume: React.Dispatch<React.SetStateAction<number>>;\n};\n\nconst Volume = React.memo(function showVolume(props: VolumeProps) {\n  let classAttribute = '';\n  let newVolume: number;\n  if (props.volume === 1) {\n    classAttribute = 'fas fa-volume-up fa-3x';\n    newVolume = 0.5;\n  } else if (props.volume === 0.5) {\n    classAttribute = 'fas fa-volume-down fa-3x';\n    newVolume = 0;\n  } else {\n    classAttribute = 'fas fa-volume-off fa-3x';\n    newVolume = 1;\n  }\n  return (\n    <div className=\"volume\">\n      <i\n        className={classAttribute}\n        onClick={() => {\n          audioPlay('audio/switch.mp3', newVolume);\n          props.setVolume(newVolume);\n        }}></i>\n    </div>\n  );\n});\n\nexport default Volume;\n","import React from 'react';\nimport Stone from './stone';\n\ntype BoardRowProps = {\n  squares: Array<string>;\n  onClick: (arg0: number) => void;\n  row: number;\n};\n\ntype BoardProps = {\n  squares: Array<string>;\n  onClick: (arg0: number) => void;\n};\n\nconst BoardRow = (props: BoardRowProps) => {\n  return (\n    <div className=\"board-row\">\n      {[0, 1, 2, 3, 4, 5, 6].map((col) => (\n        <Stone\n          key={col}\n          value={props.squares[props.row * 7 + col]}\n          onClick={() => props.onClick(col)}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst Board = (props: BoardProps): JSX.Element => {\n  return (\n    <div>\n      {[0, 1, 2, 3, 4, 5].map((id) => (\n        <BoardRow key={id} row={id} squares={props.squares} onClick={(i) => props.onClick(i)} />\n      ))}\n    </div>\n  );\n};\n\nexport default Board;\n","import React, { useCallback, useState, useEffect } from 'react';\nimport { Socket } from 'socket.io-client';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport './mobile.css';\nimport './components/remotePlay.d.ts';\n\nimport Title from './components/title';\nimport Indicator from './components/indicator';\nimport Volume from './components/volume';\nimport Board from './components/board';\nimport { isPlaceable, calculateWinner, audioPlay } from './components/utils';\nimport { enterRoom } from './components/remotePlay';\n\n// socket timeout check\n\nconst Game = () => {\n  const [history, setHistory] = useState([\n    {\n      squares: Array(42).fill(null),\n    },\n  ]);\n  const [stepNumber, setStepNumber] = useState(0);\n  const [xIsNext, setXIsNext] = useState(true);\n  const [isEnter, setIsEnter] = useState(false);\n  const [isDraw, setIsDraw] = useState(false);\n  const [volume, setVolume] = useState(0.5);\n  const [socket, setSocket] = useState<Socket | null>(null);\n  const [isMyTurn, setIsMyTurn] = useState(false);\n  const [userId, setUserId] = useState('');\n  const [roomId, setRoomId] = useState('');\n  const [status, setStatus] = useState('');\n\n  const handleClick = (i: number) => {\n    console.log('call handleClick!');\n    if (!isEnter || isDraw || (socket && !isMyTurn)) {\n      audioPlay('audio/disable.mp3', volume);\n      console.log('but return..');\n      return;\n    }\n    const newHistory = history.slice(0, stepNumber + 1);\n    const squares = newHistory[newHistory.length - 1].squares.slice();\n    const place = isPlaceable(squares, i);\n    if (calculateWinner(squares, 0) || place === null) {\n      return;\n    }\n    audioPlay('audio/switch.mp3', volume);\n    squares[place] = xIsNext ? 'X' : 'O';\n    console.log(squares);\n    console.log('step number: ' + stepNumber);\n    const winnerStreak = calculateWinner(squares, 0);\n    const winner = winnerStreak ? squares[winnerStreak[0]] : null;\n    if (winnerStreak) {\n      for (let i = 0; i < squares.length; i++) {\n        const match = winnerStreak.includes(i);\n        squares[i] = match ? winner : null;\n      }\n    }\n    let newIsDraw = false;\n    if (!winnerStreak && stepNumber === 41) {\n      newIsDraw = true;\n    }\n    setIsDraw(newIsDraw);\n    setHistory(\n      newHistory.concat([\n        {\n          squares: squares,\n        },\n      ]),\n    );\n    setStepNumber(newHistory.length);\n    setXIsNext(!xIsNext);\n    let newStatus = '';\n    if (socket) {\n      socket.emit('set', JSON.stringify({ roomId: roomId, userId: userId, col: i }));\n      newStatus = 'Wait opponent turn...';\n    }\n    setIsMyTurn(false);\n    setStatus(newStatus);\n  };\n\n  const handleMessage = useCallback(\n    (i: number) => {\n      console.log('call handleMessage!');\n      if (!isEnter || isDraw || (socket && isMyTurn)) {\n        audioPlay('audio/disable.mp3', volume);\n        console.log('but return..');\n        return;\n      }\n      const newHistory = history.slice(0, stepNumber + 1);\n      const squares = newHistory[newHistory.length - 1].squares.slice();\n      const place = isPlaceable(squares, i);\n      if (calculateWinner(squares, 0) || place === null) {\n        return;\n      }\n      audioPlay('audio/switch.mp3', volume);\n      squares[place] = xIsNext ? 'X' : 'O';\n      const winnerStreak = calculateWinner(squares, 0);\n      const winner = winnerStreak ? squares[winnerStreak[0]] : null;\n      if (winnerStreak) {\n        for (let i = 0; i < squares.length; i++) {\n          const match = winnerStreak.includes(i);\n          squares[i] = match ? winner : null;\n        }\n      }\n      let newIsDraw = false;\n      if (!winnerStreak && stepNumber === 41) {\n        newIsDraw = true;\n      }\n      setIsDraw(newIsDraw);\n      setHistory(\n        newHistory.concat([\n          {\n            squares: squares,\n          },\n        ]),\n      );\n      setStepNumber(newHistory.length);\n      setXIsNext(!xIsNext);\n      setIsMyTurn(true);\n      setStatus('your turn!');\n    },\n    [history, isDraw, isEnter, isMyTurn, socket, stepNumber, volume, xIsNext],\n  );\n\n  useEffect(() => {\n    if (socket) {\n      socket.on('init', (msg: string) => {\n        const json = JSON.parse(msg);\n        console.log(json);\n        console.log('got socket!');\n        setIsMyTurn(json.isYourTurn);\n        setUserId(json.userId);\n        setRoomId(json.roomId);\n        if (json.opponentPlayer) {\n          setIsEnter(true);\n          if (isMyTurn) setStatus('game start! its your turn!');\n          else setStatus('game start! wait opponent turn...');\n        } else {\n          setStatus('waiting opponent player...');\n        }\n      });\n\n      socket.on('set', (msg: string) => {\n        const json = JSON.parse(msg);\n        console.log(json);\n        if (json.userId === userId) {\n          console.log('got return my emit!');\n          return;\n        }\n        handleMessage(json.col);\n      });\n\n      socket.on('start', () => {\n        setIsEnter(true);\n        if (isMyTurn) setStatus('game start! its your turn!');\n        else setStatus('game start! wait opponent turn...');\n      });\n    }\n  }, [isMyTurn, socket, userId, isEnter, handleMessage, stepNumber]);\n\n  const jumpTo = (step: number) => {\n    setStepNumber(step);\n    setXIsNext(step % 2 === 0);\n  };\n\n  const resetGame = () => {\n    audioPlay('audio/switch.mp3', volume);\n    setIsDraw(false);\n    jumpTo(0);\n  };\n\n  const connectSocket = (id: string) => {\n    const socket = enterRoom(id);\n    console.log(socket);\n    if (socket) {\n      console.log('got socket!');\n      setSocket(socket);\n      setStatus(`waiting room init...`);\n    }\n  };\n\n  const current = history[stepNumber];\n  const winner_streak = calculateWinner(current.squares, 0);\n  const winner = winner_streak ? current.squares[winner_streak[0]] : null;\n\n  return (\n    <div className=\"game\">\n      <Title />\n      <div className=\"game-info\">\n        <Indicator xIsNext={xIsNext} isDraw={isDraw} winner={winner} />\n        <button className=\"reset-button\" onClick={resetGame}>\n          RESET\n        </button>\n        <Volume volume={volume} setVolume={setVolume} />\n        <button\n          className=\"enter-button\"\n          onClick={() => {\n            if (!isEnter) {\n              audioPlay('audio/bell_sound.mp3', volume);\n              setIsEnter(true);\n            }\n          }}>\n          入場 ☞\n        </button>\n      </div>\n      <input type=\"text\" name=\"roomId\" placeholder=\"Enter\" />\n      <button disabled={socket ? true : false} onClick={() => connectSocket('345')}>\n        connectWebsocket\n      </button>\n      <p>{status}</p>\n      <div className=\"game-body\">\n        <div className={'game-board' + (isEnter ? ' board-on' : '')}>\n          <Board squares={current.squares} onClick={handleClick} />\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// ========================================\nReactDOM.render(<Game />, document.getElementById('root'));\n","import { io, Socket } from 'socket.io-client';\nimport './remotePlay.d.ts';\n\n// export const SERVER_URL = 'wss://murmuring-lowlands-58469.herokuapp.com';\nexport const SERVER_URL = 'localhost:3001';\n\nexport function enterRoom(id: string): Socket | null {\n  const socket = io(SERVER_URL, { transports: ['websocket'] });\n\n  socket.on('connect', () => {\n    console.log('get connection with server!');\n    socket.emit('roomReq', JSON.stringify({ roomId: id }));\n  });\n\n  socket.on('error', (e) => {\n    console.log('failed to connect server!');\n    console.log(e);\n    return null;\n  });\n  return socket;\n}\n"],"sourceRoot":""}