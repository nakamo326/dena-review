(this["webpackJsonpdena-review"]=this["webpackJsonpdena-review"]||[]).push([[0],{21:function(e,n,t){},22:function(e,n){},32:function(e,n,t){},39:function(e,n,t){"use strict";t.r(n);var s=t(9),c=t(1),a=t.n(c),o=t(23),r=t.n(o),l=(t(21),t(32),t(22),t(0)),i=a.a.memo((function(){return Object(l.jsxs)("div",{className:"game-title",children:[Object(l.jsxs)("span",{className:"neon flash",children:["\u96fb",Object(l.jsx)("span",{children:"\u96fb"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\u8133",Object(l.jsx)("span",{children:"\u8133"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\u76e4",Object(l.jsx)("span",{children:"\u76e4"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\u4e0a",Object(l.jsx)("span",{children:"\u4e0a"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\u5a2f",Object(l.jsx)("span",{children:"\u5a2f"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\u697d",Object(l.jsx)("span",{children:"\u697d"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\xa0",Object(l.jsx)("span",{children:"\xa0"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\u56db",Object(l.jsx)("span",{children:"\u56db"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\u5b50",Object(l.jsx)("span",{children:"\u5b50"})]}),Object(l.jsxs)("span",{className:"neon flash",children:["\u68cb",Object(l.jsx)("span",{children:"\u68cb"})]})]})})),u=function(e){var n;return n=null===e.value?"":"X"===e.value?"stone-color1":"stone-color2",Object(l.jsx)("button",{className:"stone "+n,onClick:e.onClick})},j=function(e){var n,t=null,s=null;return n=e.winner?e.winner:e.xIsNext?"X":"O",e.isDraw||("X"===n?t=n:s=n),Object(l.jsxs)("div",{className:"indicator",children:[Object(l.jsx)(u,{value:t,onClick:function(){}}),Object(l.jsx)(u,{value:s,onClick:function(){}})]})};function b(e,n){for(var t=5;t>=0;t--){var s=7*t+n;if(null===e[s])return s}return null}function d(e,n){var t=Math.trunc(n/7),s=n%7,c=[[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1],[1,0],[1,1]];if(42===n)return null;if(null!==e[n])for(var a=0;a<8;a++){var o=[7*(t+0*c[a][0])+(s+0*c[a][1]),7*(t+1*c[a][0])+(s+1*c[a][1]),7*(t+2*c[a][0])+(s+2*c[a][1]),7*(t+3*c[a][0])+(s+3*c[a][1])];if(f(a,o))if(1===new Set(o.map((function(n){return e[n]}))).size)return o}return d(e,n+1)}function f(e,n){for(var t=0;t<n.length;t++){var s=n[t],c=Math.trunc(s/7),a=s%7;if(0===a&&e>=3&&e<=5||0===c&&e>=1&&e<=3||6===a&&(e<=1||7===e)||5===c&&e>=6&&e<=8)return!1}return!0}function O(e,n){var t=new Audio(e);t.volume=n,t.play().then((function(){console.log("Audio started!")})).catch((function(e){return console.warn(e)}))}var m=a.a.memo((function(e){var n,t="";return 1===e.volume?(t="fas fa-volume-up fa-3x",n=.5):.5===e.volume?(t="fas fa-volume-down fa-3x",n=0):(t="fas fa-volume-off fa-3x",n=1),Object(l.jsx)("div",{className:"volume",children:Object(l.jsx)("i",{className:t,onClick:function(){O("audio/switch.mp3",n),e.setVolume(n)}})})})),h=function(e){return Object(l.jsx)("div",{className:"board-row",children:[0,1,2,3,4,5,6].map((function(n){return Object(l.jsx)(u,{value:e.squares[7*e.row+n],onClick:function(){return e.onClick(n)}},n)}))})},v=function(e){return Object(l.jsx)("div",{children:[0,1,2,3,4,5].map((function(n){return Object(l.jsx)(h,{row:n,squares:e.squares,onClick:function(n){return e.onClick(n)}},n)}))})},p=t(27);var x=function(){var e=Object(c.useState)([{squares:Array(42).fill(null)}]),n=Object(s.a)(e,2),t=n[0],a=n[1],o=Object(c.useState)(0),r=Object(s.a)(o,2),u=r[0],f=r[1],h=Object(c.useState)(!0),x=Object(s.a)(h,2),g=x[0],N=x[1],w=Object(c.useState)(!1),k=Object(s.a)(w,2),S=k[0],C=k[1],q=Object(c.useState)(!1),y=Object(s.a)(q,2),I=y[0],J=y[1],E=Object(c.useState)(.5),X=Object(s.a)(E,2),A=X[0],M=X[1],D=Object(c.useState)(null),R=Object(s.a)(D,2),T=R[0],V=R[1],W=Object(c.useState)(!1),z=Object(s.a)(W,2),B=z[0],P=z[1],Y=Object(c.useState)(""),_=Object(s.a)(Y,2),F=_[0],G=_[1],H=Object(c.useState)(""),K=Object(s.a)(H,2),L=K[0],Q=K[1],U=Object(c.useState)(""),Z=Object(s.a)(U,2),$=Z[0],ee=Z[1],ne=Object(c.useCallback)((function(e){if(console.log("call handleMessage!"),!S||I||T&&B)return O("audio/disable.mp3",A),void console.log("but return..");var n=t.slice(0,u+1),s=n[n.length-1].squares.slice(),c=b(s,e);if(!d(s,0)&&null!==c){O("audio/switch.mp3",A),s[c]=g?"X":"O";var o=d(s,0),r=o?s[o[0]]:null;if(o)for(var l=0;l<s.length;l++){var i=o.includes(l);s[l]=i?r:null}var j=!1;o||41!==u||(j=!0),J(j),a(n.concat([{squares:s}])),f(n.length),N(!g),P(!0),ee("your turn!")}}),[t,I,S,B,T,u,A,g]);Object(c.useEffect)((function(){T&&(T.on("init",(function(e){var n=JSON.parse(e);console.log(n),console.log("got socket!"),P(n.isYourTurn),G(n.userId),Q(n.roomId),n.opponentPlayer?(C(!0),ee(B?"game start! its your turn!":"game start! wait opponent turn...")):ee("waiting opponent player...")})),T.on("set",(function(e){var n=JSON.parse(e);console.log(n),n.userId!==F?ne(n.col):console.log("got return my emit!")})),T.on("start",(function(){C(!0),ee(B?"game start! its your turn!":"game start! wait opponent turn...")})))}),[B,T,F,S,ne,u]);var te=function(e){var n=function(e){var n=Object(p.a)("localhost:3001",{transports:["websocket"]});return n.on("connect",(function(){console.log("get connection with server!"),n.emit("roomReq",JSON.stringify({roomId:e}))})),n.on("error",(function(e){return console.log("failed to connect server!"),console.log(e),null})),n}(e);console.log(n),n&&(console.log("got socket!"),V(n),ee("waiting room init..."))},se=t[u],ce=d(se.squares,0),ae=ce?se.squares[ce[0]]:null;return Object(l.jsxs)("div",{className:"game",children:[Object(l.jsx)(i,{}),Object(l.jsxs)("div",{className:"game-info",children:[Object(l.jsx)(j,{xIsNext:g,isDraw:I,winner:ae}),Object(l.jsx)("button",{className:"reset-button",onClick:function(){var e;O("audio/switch.mp3",A),J(!1),f(e=0),N(e%2===0)},children:"RESET"}),Object(l.jsx)(m,{volume:A,setVolume:M}),Object(l.jsx)("button",{className:"enter-button",onClick:function(){S||(O("audio/bell_sound.mp3",A),C(!0))},children:"\u5165\u5834 \u261e"})]}),Object(l.jsx)("input",{type:"text",name:"roomId",placeholder:"Enter"}),Object(l.jsx)("button",{disabled:!!T,onClick:function(){return te("345")},children:"connectWebsocket"}),Object(l.jsx)("p",{children:$}),Object(l.jsx)("div",{className:"game-body",children:Object(l.jsx)("div",{className:"game-board"+(S?" board-on":""),children:Object(l.jsx)(v,{squares:se.squares,onClick:function(e){if(console.log("call handleClick!"),!S||I||T&&!B)return O("audio/disable.mp3",A),void console.log("but return..");var n=t.slice(0,u+1),s=n[n.length-1].squares.slice(),c=b(s,e);if(!d(s,0)&&null!==c){O("audio/switch.mp3",A),s[c]=g?"X":"O",console.log(s),console.log("step number: "+u);var o=d(s,0),r=o?s[o[0]]:null;if(o)for(var l=0;l<s.length;l++){var i=o.includes(l);s[l]=i?r:null}var j=!1;o||41!==u||(j=!0),J(j),a(n.concat([{squares:s}])),f(n.length),N(!g);var m="";T&&(T.emit("set",JSON.stringify({roomId:L,userId:F,col:e})),m="Wait opponent turn..."),P(!1),ee(m)}}})})})]})};r.a.render(Object(l.jsx)(x,{}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.02dd1aa2.chunk.js.map